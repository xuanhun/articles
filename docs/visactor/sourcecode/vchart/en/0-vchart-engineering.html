<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0 VChart Engineering</title>
    <meta name="keywords" content="VisActor,VChart,VTable,VStrory,VMind,VGrammar,VRender,Visualization,Chart,Data,Table,Graph,Gis,LLM">
    <style>
        body {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
            line-height: 1.6;
            color: #24292e;
            background-color: #fff;
        }
        h1, h2, h3, h4, h5, h6 {
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
        }
        h1 { font-size: 2em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h2 { font-size: 1.5em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h3 { font-size: 1.25em; }
        code {
            padding: 0.2em 0.4em;
            margin: 0;
            font-size: 85%;
            background-color: rgba(27,31,35,0.05);
            border-radius: 3px;
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
        }
        pre {
            padding: 16px;
            overflow: auto;
            font-size: 85%;
            line-height: 1.45;
            background-color: #f6f8fa;
            border-radius: 6px;
        }
        pre code {
            background-color: transparent;
            padding: 0;
            font-size: 100%;
        }
        img {
            max-width: 100%;
            height: auto;
            box-sizing: content-box;
            background-color: #fff;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 16px 0;
            display: block;
            overflow: auto;
        }
        table th, table td {
            padding: 6px 13px;
            border: 1px solid #d0d7de;
        }
        table th {
            font-weight: 600;
            background-color: #f6f8fa;
        }
        table tr {
            background-color: #fff;
            border-top: 1px solid #d0d7de;
        }
        table tr:nth-child(2n) {
            background-color: #f6f8fa;
        }
        a {
            color: #0969da;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        blockquote {
            padding: 0 1em;
            color: #656d76;
            border-left: 0.25em solid #d0d7de;
            margin: 0 0 16px 0;
        }
        hr {
            height: 0.25em;
            padding: 0;
            margin: 24px 0;
            background-color: #d0d7de;
            border: 0;
        }
        ul, ol {
            padding-left: 2em;
        }
        li + li {
            margin-top: 0.25em;
        }
    </style>
</head>
<body>
    <h1 id="01-start-demo">0.1 Start demo</h1>
<h2 id="011-fork-the-project">0.1.1 Fork the project</h2>
<p>On Github, you need to Fork the VChart project.    </p>
<p><img src='https://cdn.jsdelivr.net/gh/xuanhun/articles/visactor/sourcecode/img/XgFMbjw62o7QnDxfi62cfY6znKe.gif' alt='' width='1000' height='auto' /></p>
<h2 id="012-clone-the-project">0.1.2 Clone the Project</h2>
<p>In the repository you forked, click the <code>Code</code> button to copy the project address. Then use the git clone command to clone the project locally. For example:    </p>
<pre class="codehilite"><code class="language-bash">git clone https://github.com/your-username/VChart.git    
</code></pre>

<p>After cloning, you need to add the remote address of VChart.    </p>
<pre class="codehilite"><code class="language-bash">git remote add upstream https://github.com/VisActor/VChart.git    
</code></pre>

<p>This way, you can get the latest source code from the remote address of VChart.    </p>
<pre class="codehilite"><code class="language-bash">git pull upstream develop    
</code></pre>

<h2 id="013-start-demo">0.1.3 Start demo</h2>
<p>We use <a href="https://rushjs.io/">@microsoft/rush</a> to manage the monorepo. So, first install rush.</p>
<pre class="codehilite"><code class="language-bash">npm install -g @microsoft/rush    
</code></pre>

<p>Next, execute the command to start the demo.    </p>
<pre class="codehilite"><code class="language-typescript">*安装依赖*
$ rush update
*启动 vchart 的demo页*
$ rush start
*启动 react-vchart 的demo页*
$ rush react
*启动本地文档站点*
$ rush docs    
</code></pre>

<h2 id="014-what-happens-when-starting-the-demo">0.1.4 What happens when starting the demo?</h2>
<p>When you run <code>rush start</code>, it will launch the demo page of vchart. But what exactly happens?</p>
<p>First, we configured the <code>start</code> command in <code>command-line.json</code>:</p>
<pre class="codehilite"><code class="language-json">{&quot;commandKind&quot;: &quot;global&quot;,&quot;name&quot;: &quot;start&quot;,&quot;summary&quot;: &quot;Start the development server&quot;,&quot;description&quot;: &quot;Run this command to start vchart development server&quot;,&quot;shellCommand&quot;: &quot;rush run -p @visactor/vchart -s start&quot;},    
</code></pre>

<p>So we know that the start command will execute the <code>rush run -p @visactor/vchart -s start</code> command.    </p>
<p>Let me explain the <code>rush run -p @visactor/vchart -s start</code> command in detail:    </p>
<p>This is a command from the Rush tool, which can be broken down into the following parts:    </p>
<ol>
<li>
<p><code>rush run</code>: A subcommand of Rush, used to run specific project npm scripts in a monorepo    </p>
</li>
<li>
<p><code>-p @visactor/vchart</code>: The <code>-p</code> or <code>--project</code> parameter specifies the project name for which the script is to be run, here it specifies the @visactor/vchart project    </p>
</li>
<li>
<p><code>-s start</code>: The <code>-s</code> or <code>--script</code> parameter specifies the npm script name to be run, here the start script is to be run    </p>
</li>
</ol>
<p>According to the codebase, we can see that this command will eventually execute the start script defined in the package.json of the @visactor/vchart package:    </p>
<pre class="codehilite"><code class="language-bash">ts-node __tests__/runtime/browser/scripts/initVite.ts &amp;&amp; vite serve __tests__/runtime/browser    
</code></pre>

<p>The first part of this command runs the initialization script <code>initVite.ts</code>, which mainly generates the local version files <code>vite.config.local.ts</code> and <code>index.page.local.ts</code>. These files are ignored by git and are used for local development configuration, which will be explained in detail later.</p>
<p>The second part of the script <code>vite serve __tests__/runtime/browser</code> is to launch the demo webpage.</p>
<h2 id="015-how-to-use-indexpagelocalts">0.1.5 How to use <code>index.page.local.ts</code></h2>
<p>The default content of this file is</p>
<pre class="codehilite"><code class="language-xml">import './test-page/area';    
</code></pre>

<p>Generally speaking, it can be used to specify launching different chart pages. In fact, it runs the VChart table generation code of different files to achieve the effect of launching different chart pages on the web. So you just need to import different files to launch different chart pages.    </p>
<h2 id="016-how-to-use-viteconfiglocalts">0.1.6 How to use <code>vite.config.local.ts</code></h2>
<p>This file is mainly used to configure ports and local packages. For example, the following configuration:    </p>
<pre class="codehilite"><code class="language-xml">export default {
  *// 启动端口*port: 4000,
  resolve: {
    alias: {
      '@visactor/vgrammar-core': '/path/to/visactor/VGrammar/packages/vgrammar-core/src/index.ts',
      '@visactor/vgrammar-util': '/path/to/visactor/VGrammar/packages/vgrammar-util/src/index.ts',
      '@visactor/vgrammar-wordcloud': '/path/to/visactor/VGrammar/packages/vgrammar-wordcloud/src/index.ts',
      '@visactor/vgrammar-wordcloud-shape': '/path/to/visactor/VGrammar/packages/vgrammar-wordcloud-shape/src/index.ts',
      '@visactor/vgrammar-sankey': '/path/to/visactor/VGrammar/packages/vgrammar-sankey/src/index.ts',
      '@visactor/vgrammar-hierarchy': '/path/to/visactor/VGrammar/packages/vgrammar-hierarchy/src/index.ts',
      '@visactor/vgrammar-projection': '/path/to/visactor/VGrammar/packages/vgrammar-projection/src/index.ts',
      '@visactor/vgrammar-coordinate': '/path/to/visactor/VGrammar/packages/vgrammar-coordinate/src/index.ts',
      '@visactor/vgrammar-venn': '/path/to/visactor/VGrammar/packages/vgrammar-venn/src/index.ts',
      '@visactor/vscale': '/path/to/visactor/VUtil/packages/vscale/src/index.ts',
      '@visactor/vdataset': '/path/to/visactor/VUtil/packages/vdataset/src/index.ts',
      '@visactor/vutils': '/path/to/visactor/VUtil/packages/vutils/src/index.ts',
      '@visactor/vrender-core': '/path/to/visactor/VRender/packages/vrender-core/src/index.ts',
      '@visactor/vrender-kits': '/path/to/visactor/VRender/packages/vrender-kits/src/index.ts',
      '@visactor/vrender-components': '/path/to/visactor/VRender/packages/vrender-components/src/index.ts'
    }
  }
};    
</code></pre>

<p>它把启动端口配置为 4000，并且配置了一系列的本地包，这样你的 VChart 在调试时会依赖这些本地包，你对上游本地包的改动会实时生效，方便调试一些和上游有关的 bug，如果你不需要这个功能，去掉这些配置即可。    </p>
<h1 id="02-detailed-explanation-of-vchart-engineering">0.2 Detailed Explanation of VChart Engineering</h1>
<h2 id="021-project-structure">0.2.1 Project Structure</h2>
<p>VChart is a monorepo project managed using Rush, mainly consisting of the following parts:    </p>
<p>Core Packages:    </p>
<ol>
<li>
<p>@visactor/vchart - Core chart library    </p>
</li>
<li>
<p>@visactor/react-vchart - React wrapper    </p>
</li>
<li>
<p>@visactor/openinula-vchart - OpenInula wrapper    </p>
</li>
<li>
<p>@visactor/taro-vchart - Taro wrapper    </p>
</li>
<li>
<p>@visactor/lark-vchart - Lark wrapper    </p>
</li>
<li>
<p>@visactor/wx-vchart - WeChat Mini Program wrapper    </p>
</li>
<li>
<p>@visactor/vchart-schema - Chart configuration schema    </p>
</li>
<li>
<p>@visactor/vchart-types - TypeScript type definitions    </p>
</li>
<li>
<p>@visactor/vutils-extension - Utility function extensions    </p>
</li>
<li>
<p>@visactor/tt-vchart - ByteDance Mini Program wrapper    </p>
</li>
</ol>
<p>Tool Packages:    </p>
<ol>
<li>
<p>@internal/bundler - Bundling tool    </p>
</li>
<li>
<p>@internal/typescript-json-schema - TypeScript type definition generation tool    </p>
</li>
<li>
<p>@internal/story-player - Story player    </p>
</li>
<li>
<p>@internal/bugserver-trigger - Bug service trigger    </p>
</li>
</ol>
<h2 id="022-documentation-system">0.2.2 Documentation System</h2>
<p>The content of the documentation is stored in the <code>docs/assets</code> folder, including:    </p>
<ul>
<li>
<p>API documentation    </p>
</li>
<li>
<p>Example code    </p>
</li>
<li>
<p>Tutorial documentation    </p>
</li>
<li>
<p>Configuration documentation    </p>
</li>
<li>
<p>Theme documentation    </p>
</li>
</ul>
<h2 id="023-development-commands">0.2.3 Development Commands</h2>
<ul>
<li>
<p>rush update - Install dependencies    </p>
</li>
<li>
<p>rush start - Start the vchart development service    </p>
</li>
<li>
<p>rush react - Start the react-vchart development service    </p>
</li>
<li>
<p>rush docs - Start the documentation development service    </p>
</li>
</ul>
<p># This document was revised and organized by the following personnel 
 <a href="https://github.com/xuanhun">玄魂</a></p>
</body>
</html>