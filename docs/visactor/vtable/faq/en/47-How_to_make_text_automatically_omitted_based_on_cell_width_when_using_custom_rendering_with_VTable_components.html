<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>25. How to make text automatically omitted based on cell width when using custom rendering with VTable components?</br></title>
    <meta name="keywords" content="VisActor,VChart,VTable,VStrory,VMind,VGrammar,VRender,Visualization,Chart,Data,Table,Graph,Gis,LLM">
    <style>
        body {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
            line-height: 1.6;
            color: #24292e;
            background-color: #fff;
        }
        h1, h2, h3, h4, h5, h6 {
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
        }
        h1 { font-size: 2em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h2 { font-size: 1.5em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h3 { font-size: 1.25em; }
        code {
            padding: 0.2em 0.4em;
            margin: 0;
            font-size: 85%;
            background-color: rgba(27,31,35,0.05);
            border-radius: 3px;
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
        }
        pre {
            padding: 16px;
            overflow: auto;
            font-size: 85%;
            line-height: 1.45;
            background-color: #f6f8fa;
            border-radius: 6px;
        }
        pre code {
            background-color: transparent;
            padding: 0;
            font-size: 100%;
        }
        img {
            max-width: 100%;
            height: auto;
            box-sizing: content-box;
            background-color: #fff;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 16px 0;
            display: block;
            overflow: auto;
        }
        table th, table td {
            padding: 6px 13px;
            border: 1px solid #d0d7de;
        }
        table th {
            font-weight: 600;
            background-color: #f6f8fa;
        }
        table tr {
            background-color: #fff;
            border-top: 1px solid #d0d7de;
        }
        table tr:nth-child(2n) {
            background-color: #f6f8fa;
        }
        a {
            color: #0969da;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        blockquote {
            padding: 0 1em;
            color: #656d76;
            border-left: 0.25em solid #d0d7de;
            margin: 0 0 16px 0;
        }
        hr {
            height: 0.25em;
            padding: 0;
            margin: 24px 0;
            background-color: #d0d7de;
            border: 0;
        }
        ul, ol {
            padding-left: 2em;
        }
        li + li {
            margin-top: 0.25em;
        }
    </style>
</head>
<body>
    <h2 id="question-title">Question Title</h2>
<p>How to make text automatically omitted based on cell width when using custom rendering with VTable components?</br></p>
<h2 id="question-description">Question Description</h2>
<p>When using custom rendering with VTable in the product, the cell contains icon and text elements. It is expected that the column width can be automatically calculated based on the content at initial, and when manually dragging to resize the column width, the text can automatically be omitted instead of having the button float over the text. I am not sure how to write the code to achieve this effect of shrinking the column width and making the text turn into an sign '...'</br>
<img src='https://cdn.jsdelivr.net/gh/xuanhun/articles/visactor/img/BV6ObuIlso57Khx9BbrcIeJnnJg.gif' alt='' width='934' height='764'></p>
<h2 id="solution">Solution</h2>
<p>We use the customLayout provided by VTable, which can automatically layout and automatically measure the width to adapt to the cell width. The specific writing method is as follows:</br></p>
<pre class="codehilite"><code>  customLayout: (args) =&gt; {
        const { table,row,col,rect } = args;
        const record = table.getRecordByCell(col,row);
        const  {height, width } = rect ?? table.getCellRect(col,row);
        const container = new VTable.CustomLayout.Group({
          height,
          width,
          display: 'flex',
          flexWrap:'no-wrap',
          alignItems: 'center',
          justifyContent: 'flex-front'
       });
        const bloggerAvatar = new VTable.CustomLayout.Image({
          id: 'icon0',
          width: 20,
          height: 20,
          image:record.bloggerAvatar,
          cornerRadius: 10,
        });
        container.add(bloggerAvatar);
        const bloggerName = new VTable.CustomLayout.Text({
          text:record.bloggerName,
          fontSize: 13,
          x:20,
          fontFamily: 'sans-serif',
          fill: 'black',
          maxLineWidth:width===null?undefined:width-20+1
        });
        container.add(bloggerName);
        return {
          rootContainer: container,
          renderDefault: false,
        };
      }&lt;/br&gt;
</code></pre>

<p>CustomLayout needs to return a rootContainer, usually a Group object, to serve as a container for other content. Here, <code>flexWrap</code> is set so that internal elements (icon and text) do not wrap, and <code>alignItems</code> and <code>justifyContent</code> are used for horizontal and vertical alignment. The Group contains an Image and Text. If you want the text to automatically truncate with... when the space is compressed, you need to configure <code>maxLineWidth</code>. A special point here is that when <code>column</code> is set to <code>'auto'</code>, the value of <code>width</code> received by the <code>customLayout</code> function is <code>null</code>, so you need to check if it is <code>null</code>. If it is <code>null</code>, set <code>maxLineWidth</code> to <code>undefined</code> to automatically expand the width of the cell. If it is not <code>null</code>, set <code>maxLineWidth</code> according to the value of <code>width</code>. Subtracting 20 here avoids the width of the image, and the additional +1 is a buffer value that can be ignored.</br></p>
<h2 id="code-examples">Code Examples</h2>
<pre class="codehilite"><code>  const option = {
    columns:[
      {
        field: 'bloggerId',
        title:'order number'
      }, 
      {
        field: 'bloggerName',
        title:'anchor nickname',
        width:'auto',
        style:{
          fontFamily:'Arial',
          fontWeight:500
        },
      customLayout: (args) =&gt; {
        const { table,row,col,rect } = args;
        const record = table.getRecordByCell(col,row);
        const  {height, width } = rect ?? table.getCellRect(col,row);
        const container = new VTable.CustomLayout.Group({
          height,
          width,
          display: 'flex',
          flexWrap:'no-wrap',
          alignItems: 'center',
          justifyContent: 'flex-front'
       });
        const bloggerAvatar = new VTable.CustomLayout.Image({
          id: 'icon0',
          width: 20,
          height: 20,
          image:record.bloggerAvatar,
          cornerRadius: 10,
        });
        container.add(bloggerAvatar);
        const bloggerName = new VTable.CustomLayout.Text({
          text:record.bloggerName,
          fontSize: 13,
          x:20,
          fontFamily: 'sans-serif',
          fill: 'black',
          maxLineWidth:width===null?undefined:width-20+1
        });
        container.add(bloggerName);
        return {
          rootContainer: container,
          renderDefault: false,
        };
      }
    },
    {
      field: 'fansCount',
      title:'fansCount',
      fieldFormat(rec){
        return rec.fansCount + 'w'
      },
      style:{
        fontFamily:'Arial',
        fontSize:12,
        fontWeight:'bold'
      }
    }, 
    ],
   records:[
   {
      'bloggerId': 1,
      &quot;bloggerName&quot;: &quot;Virtual Anchor Xiaohua duoduo&quot;,
      &quot;bloggerAvatar&quot;: &quot;https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/flower.jpg&quot;,
      &quot;introduction&quot;: &quot;Hi everyone, I am Xiaohua, the virtual host. I am a little fairy who likes games, animation and food. I hope to share happy moments with you through live broadcast.&quot;,
      &quot;fansCount&quot;: 400,
      &quot;worksCount&quot;: 10,
      &quot;viewCount&quot;: 5,
      &quot;city&quot;: &quot;Dream City&quot;,
      &quot;tags&quot;: [&quot;game&quot;, &quot;anime&quot;, &quot;food&quot;]
    },
    {
      'bloggerId': 2,
      &quot;bloggerName&quot;: &quot;Virtual anchor little wolf&quot;,
      &quot;bloggerAvatar&quot;: &quot;https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/wolf.jpg&quot;,
      &quot;introduction&quot;: &quot;Hello everyone, I am the virtual anchor Little Wolf. I like music, travel and photography, and I hope to explore the beauty of the world with you through live broadcast.&quot;,
      &quot;fansCount&quot;: 800,
      &quot;worksCount&quot;: 20,
      &quot;viewCount&quot;: 15,
      &quot;city&quot;: &quot;City of Music&quot;,
      &quot;tags&quot;: [&quot;music&quot;, &quot;travel&quot;, &quot;photography&quot;]
      }
    ],
    defaultRowHeight:30
  };

const tableInstance = new VTable.ListTable(document.getElementById(CONTAINER_ID),option);
window['tableInstance'] = tableInstance;&lt;/br&gt;
</code></pre>

<h2 id="result-display">Result Display</h2>
<p>Just paste the code in the example code directly into the official editor to present it.</br>
<img src='https://cdn.jsdelivr.net/gh/xuanhun/articles/visactor/img/CP0QbZnjIoNnwyxMvjlc17hdnKf.gif' alt='' width='388' height='142'></p>
<h2 id="related-documents">Related documents</h2>
<p>Tutorial on customLayout usage: <a href="https%3A%2F%2Fvisactor.io%2Fvtable%2Fguide%2Fcustom_define%2Fcustom_layout">https://visactor.io/vtable/guide/custom_define/custom_layout</a></br>
Demo of customLayout usage: <a href="https%3A%2F%2Fvisactor.io%2Fvtable%2Fdemo%2Fcustom-render%2Fcustom-cell-layout">https://visactor.io/vtable/demo/custom-render/custom-cell-layout</a></br>
Related API: <a href="https%3A%2F%2Fvisactor.io%2Fvtable%2Foption%2FListTable-columns-text%23customLayout">https://visactor.io/vtable/option/ListTable-columns-text#customLayout</a></br>
github：https://github.com/VisActor/VTable</br></p>
</body>
</html>